<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ include file="/WEB-INF/jsp/include/common.jsp"%>
<!DOCTYPE html>
<html>
<head>
  <!-- meta -->
    <title>통합산업보건 | 대한산업보건협회</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=1190" />

    <meta name="_csrf_header" id="_csrf_header" content="X-XSRF-TOKEN">
    <meta name="_csrf" id="_csrf" content="52cb9d18-460c-4580-b26b-e373cd889eb0">
    <meta property="og:image" content="http://www.atos.co.kr/kiha.iohp/images/logo.png">
  

	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" /><!-- 노토산 굵은 폰트 -->
	<link rel="stylesheet" href="${pageContext.request.contextPath}/css/common.css" />
	<link rel="stylesheet" href="${pageContext.request.contextPath}/css/size.css" />
	<script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
	<script src="http://testh.kiha21.or.kr/assets/js/commons/stickyfill.min.js"></script>
	<script src="http://testh.kiha21.or.kr/assets/js/commons/jquery-1.12.4.min.js"></script>
	<script src="http://testh.kiha21.or.kr/assets/js/commons/common.js?1"></script>
	<script src="http://testh.kiha21.or.kr/public/moment/moment-with-locales.min.js"></script> 
	<script src="${pageContext.request.contextPath}/js/common.js"></script> 
</head>
<body>
 <section>
    <div class="pop_title">안전보건관리 > 안전보건관리체제 > 건강관리실관리 > 자동제세동기관리 > 점검표</div>
   <!-- ### HTML ###-->
	  <!-- #container -->
   	 <div id="container">
        <div class="inner">
          <!-- 하단여백 섹션으로 구분 -->
            <div class="con_area">       
       			 <div class="mt20">
					  	<section id="content">
					  	<div class="btn_top">            
					            <a href="javascript:void(0)" class="btn_round btn_modi btn_Tw" id="readMoreBtn" style="width:300px;"><span>자세히 보기</span></a>
					            <a href="javascript:void(0)" class="btn_round btn_modi btn_Tw" id="viewSmryBtn" style="width:300px;"><span>요약보기</span></a>
						</div>
					    	<div class="button-group top">
					    	</div>
						   <table class="board-list" id="viewSmryTb">
						        <col style="width: 50px">
						        <col style="width: 50px">
						        <col style="width: 100px">
						        <col style="width: 120px">
						        <col style="width: 100px">
						        <col style="width: 100px">
						        <col style="width: 100px">
						        <col style="width: 100px">
						        <col style="width: 100px">
						        <col style="width: 100px">
						        <col style="width: 100px">
						      </colgroup>
						      <thead>
						        <tr>
						          <th><input type="checkbox" name="agree2" value="Y"></th>
						          <th>NO</th>
						          <th>검진일자</th>
						          <th>단위사체업체</th>
						          <th>공정</th>
						          <th>성명</th>
						          <th>성별</th>
						          <th>근무년수</th>
						          <th>검진구분</th>
						          <th>판정</th>
						          <th>업체적합성</th>
						        </tr>
						      </thead>
						      <tbody id="dataSection" name="tbody"></tbody>
						    </table>
						    <table class="board-list" id="readMoreTb">
						        <col style="width: 50px">
						        <col style="width: 50px">
						        <col style="width: 100px">
						        <col style="width: 120px">
						        <col style="width: 80px">
						        <col style="width: 80px">
						        <col style="width: 80px">
						        <col style="width: 100px">
						        <col style="width: 110px">
						        <col style="width: 100px">
						        <col style="width: 100px">
						        <col style="width: 90px"> 
						        <col style="width: 90px"> 
						        <col style="width: 110px">
						        <col style="width: 90px">
						        <col style="width: 110px"> 
						        <col style="width: 110px">
						        <col style="width: 90px">
						        <col style="width: 90px">
						        <col style="width: 120px">
						        <col style="width: 150px">
						        <col style="width: 90px">
						        <col style="width: 180px">
						        <col style="width: 180px">
						        <col style="width: 180px">
						        <col style="width: 90px">
						        <col style="width: 90px">
						        <col style="width: 120px">
						        <col style="width: 90px">
						        <col style="width: 90px">
						        <col style="width: 90px">
						        <col style="width: 90px">
						        <col style="width: 90px">
						      </colgroup>
						      <thead>
						        <tr>
						          <th><input type="checkbox" name="agree2" value="Y"></th>
						          <th>NO</th>
						          <th>검진일자</th>
						          <th>단위사체업체</th>
						          <th>공정</th>
						          <th>성명</th>
						          <th>성별</th>
						          <th>근무년수</th>
						          <th>검진구분</th>
						          <th>판정</th>
						          <th>업체적합성</th>
						          <th>키</th>
						          <th>몸무게</th>
						          <th>체질량지수</th>
						          <th>허리둘레</th>
						          <th>혈압(수축기)</th>
						          <th>혈압(이완기)</th>
						          <th>혈색소</th>
						          <th>공복혈당</th>
						          <th>총콜레스테롤</th>
						          <th>고밀도 콜레스테롤</th>
						          <th>중성지방</th>
						          <th>저밀도 콜레스테롤</th>
						          <th>혈청 크레아티닌</th>
						          <th>신사구체 여과율</th>
						          <th>AST</th>
						          <th>ALT</th>
						          <th>감마 지티피</th>
						          <th>요단백</th>
						          <th>흉부촬영</th>
						          <th>과거병력</th>
						          <th>약물치료</th>
						          <th>기타</th>
						        </tr>
						      </thead>
						      <tbody id="dataSection" name="tbody"></tbody>
						    </table>
						    <input type="hidden" id="examTp" value ="">
						    <input type="hidden" id="examStrDd" value ="">
						    <input type="hidden" id="examEndDd" value ="">
						    <input type="hidden" id="viewSmryYN" value ="Y">
					  </section>
			        </div>
			    </div>
        	</div>
		</div>
	</section>
<script>
//부모창 값 받기
/*var bzRgstNo = bzRgstNo; */
var medExamTp = medExamTp;
var medExamStrDd = medExamStrDd;
var medExamEndDd = medExamEndDd;

var examTp = $("#examTp").val(medExamTp);
var examStrDd = $("#examStrDd").val(medExamStrDd);
var examEndDd = $("#examEndDd").val(medExamEndDd);

console.log(":::::::::::::::::::::" + medExamTp);

$(document).ready(function() {
	$("#viewSmryBtn").hide();
	$("#viewSmryTb").show();
	$("#readMoreBtn").show();
	$("#readMoreTb").hide();
	getPage();
})

function getPage(page) {
	var searchType = $("#searchType").val();
	var search = $("#searchInput").val();
	var examTp = $("#examTp").val();
	var examStrDd = $("#examStrDd").val();
	var examEndDd = $("#examEndDd").val();
	var viewSmryYN = $("#viewSmryYN").val();
	$.ajax({
				url : "/page/KW30000/KW30000U2200chkPopList", //서비스 주소 
				data : {  //서비스 처리에 필요한 인자값
					comSearchValA : examTp,
					comSearchValB : examStrDd,
					comSearchValC : examEndDd,
					page : page,
					searchType : searchType,
					keyword : search				
				},
				success : function(res) {
					const list = res['resultList'];
					const pagination = res['pagination'];
					var totalCnt = "";
					var data = "";
					var block = "";
					//페이지 번호 위치				

					if(list.length !== 0){					
					// 테이블의 row를 삽입하는 부분
					for (var i = 0; i < list.length; i++) {
						data += '<tr>';
						data += '<td><input type="checkbox" name="agree2" value="'+ list[i].seq+ '"></td>';
						data += '<td style="display:none" class="seq">' + list[i].seq + '</td>';
						data += '<td style="display:none" class="bzRgstNo">' + list[i].bzRgstNo + '</td>';
						data += '<td class="rnum">' + list[i].rnum + '</td>';
						data += '<td class="medExamDd">' + list[i].medExamDd + '</td>';
						data += '<td class="unitCoNm">' + list[i].unitCoNm + '</td>';
						data += '<td class="prcsNm">' + list[i].prcsNm + '</td>';
						data += '<td class="wrkrNm">' + list[i].wrkrNm + '</td>';
						data += '<td class="gndr">' + list[i].gndr + '</td>';
						data += '<td class="srvIndctnCrs">' + list[i].srvIndctnCrs + '</td>';
						data += '<td class="examTp">' + list[i].examTp + '</td>';
						data += '<td class="jdgRslt">' + list[i].jdgRslt + '</td>';
						data += '<td class="wrkSuit">' + list[i].wrkSuit + '</td>';
						if(viewSmryYN != 'Y'){
							data += '<td class="hgt">' + list[i].hgt + '</td>';
							data += '<td class="wgt">' + list[i].wgt + '</td>';
							data += '<td class="bmi">' + list[i].bmi + '</td>';
							data += '<td class="wstCrcm">' + list[i].wstCrcm + '</td>';
							data += '<td class="sbp">' + list[i].sbp + '</td>';
							data += '<td class="dbp">' + list[i].dbp + '</td>';
							data += '<td class="hemo">' + list[i].hemo + '</td>';
							data += '<td class="fastGluco">' + list[i].fastGluco + '</td>';
							data += '<td class="totChol">' + list[i].totChol + '</td>';
							data += '<td class="hdl">' + list[i].hdl + '</td>';
							data += '<td class="nf">' + list[i].nf + '</td>';
							data += '<td class="ldl">' + list[i].ldl + '</td>';
							data += '<td class="scr">' + list[i].scr + '</td>';
							data += '<td class="egfr">' + list[i].egfr + '</td>';
							data += '<td class="ast">' + list[i].ast + '</td>';
							data += '<td class="art">' + list[i].art + '</td>';
							data += '<td class="gamaGtp">' + list[i].gamaGtp + '</td>';
							data += '<td class="urne">' + list[i].urne + '</td>';
							data += '<td class="chstFoto">' + list[i].chstFoto + '</td>';
							data += '<td class="pstMedCaseHst">' + list[i].pstMedCaseHst + '</td>';
							data += '<td class="mdCure">' + list[i].mdCure + '</td>';
							data += '<td class="othr">' + list[i].othr + '</td>'; 
						}
						data += '</tr>';
					}
					
					} else {
						data += "<tr>";
						if(viewSmryYN == 'Y'){
							data += "<td colspan='11'>등록된 게시글이 없습니다.</td>";
						}else {
							data += "<td colspan='30'>등록된 게시글이 없습니다.</td>";
						}
						data += "</tr>";						
					} 
					// 이전버튼 활성화 여부를 결정하는 부분
					if (pagination['prev']) {
						block += "<a href='javascript:getPage("
								+ pagination['page'] + ")'> << </a>";
						block += "<a href='javascript:getPage("
								+ (pagination['startPage'] - 1)
								+ ")'> < </a>";
						// 시작 페이지 > 처리
					}
					// 번호를 표시하는 부분
					for (var i = pagination['startPage']; i < pagination['endPage'] + 1; i++) {
						block += "<a class='page-link' href='javascript:getPage("
								+ i + ")'>" + i + "</a>";
					}

					// 다음페이지 여부
					if (pagination['next'] && pagination['endPage'] > 0) {
						block += "<a href='javascript:getPage("
								+ (pagination['endPage'] + 1)
								+ ")'> > </a>";
						block += "<a href='javascript:getPage("
								+ (Math.ceil(pagination['totalCount']
										/ pagination.cri['perPageNum']))
								+ ")'> >> </a>";
					}
					$("#totalCnt").html(totalCnt);						
					$("#dataSection").html(data);
					$("#paginationBox").html(block);
					// 물어보기
					$("tbody").html(data);
					$("#insertBtn").show();
					$("#deleteBtn").show();
					$("#updateBtn").show();
					$("#printBtn").show();
					$("#saveBtn").hide();
 					$("#cancelBtn").hide();
				}
			})
}


	//수정 버튼 클릭시 ajax호출
$("#readMoreBtn").on("click", function() {
	 $("#viewSmryYN").val("N");
	 $("#viewSmryBtn").show();
	 $("#readMoreBtn").hide();
	 $("#readMoreTb").show();
	 $("#viewSmryTb").hide();
	 getPage();
});
	
$("#viewSmryBtn").on("click", function() {
	 $("#viewSmryYN").val("Y");
	 $("#readMoreBtn").show();
	 $("#viewSmryBtn").hide();
	 $("#readMoreTb").hide();
	 $("#viewSmryTb").show();
	 getPage();
});




	
</script>